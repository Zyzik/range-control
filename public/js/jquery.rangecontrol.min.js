(function(){var t;t=function(){function t(t,e){this.el=t,this.settings=$.extend({},this.defaultOptions,e),this._formatControlCallback=this.settings.formatControlCallback,this._leftControl=this.el.find(".range-control_mini__left"),this._rightControl=this.el.find(".range-control_mini__right"),this._rangeElement=this.el.find(".range-control_mini__range.is-active"),this.startValue(this.el.data("start-value")||this.settings.startValue),this.endValue(this.el.data("end-value")||this.settings.endValue),this.valueStep(this.el.data("value-step")||this.settings.valueStep),this._controlWidth=this._leftControl.outerWidth(),this._width=this.el.outerWidth(),this._widthWithoutPaddings=this.el.width(),this._pxInValue=this._widthWithoutPaddings/(this._endValue-this._startValue),this.leftValue(this.el.data("left-value")||this.settings.leftValue||this._startValue),this.rightValue(this.el.data("right-value")||this.settings.rightValue||this._endValue),this._initControls()}return t._dragged=!1,t._startValue=0,t._endValue=100,t._valueStep=0,t._draggedClassName="is-dragged",t._renderControlCallback,t._width,t._widthWithoutPaddings,t._controlWidth,t._pxInValue,t._leftControlValue,t._rightControlValue,t._rangeElement,t.settings,t.prototype.defaultOptions={startValue:0,endValue:100,valueStep:1,timeout:1e3,formatControlCallback:function(t){return t}},t.prototype.startValue=function(t){return null!=t?this._startValue=parseInt(t):this._startValue},t.prototype.endValue=function(t){return null!=t?this._endValue=parseInt(t):this._endValue},t.prototype.valueStep=function(t){return null!=t?this._valueStep=parseInt(t):this._valueStep},t.prototype.leftValue=function(t){return null!=t?(this._leftValueWithoutRender(t),this._renderLeftControl(t)):this._leftValueWithoutRender(t)},t.prototype._leftValueWithoutRender=function(t){return null!=t?(this._leftControlValue=t>=this._startValue?t:this._startValue,this._renderRange(),this._formatLeftControl()):1===this._valueStep?this._leftControlValue:this._startValue+(this._leftControlValue-this._startValue-(this._leftControlValue-this._startValue)%this._valueStep)},t.prototype.rightValue=function(t){return null!=t?(this._rightValueWithoutRender(t),this._renderRightControl(t)):this._rightValueWithoutRender(t)},t.prototype._rightValueWithoutRender=function(t){return null!=t?(this._rightControlValue=this._endValue>=t?t:this._endValue,this._renderRange(),this._formatRightControl()):1===this._valueStep?this._rightControlValue:this._startValue+(this._rightControlValue-this._startValue-(this._rightControlValue-this._startValue)%this._valueStep)},t.prototype.renderControl=function(t){return null!=t&&"function"==typeof t?this._renderControlCallback=t:void 0},t.prototype._getValueByPosition=function(t){return this._startValue+parseInt(t/this._pxInValue)},t.prototype._initControls=function(){var t,e=this;return t=[this._leftControl,this._rightControl],t.forEach(function(t){return t.on("dragstart",function(){return!1}),t.on("mouseup",function(){return e.dragged=!1,e._leftControl.removeClass(e._draggedClassName),$(document).off("mousemove")})}),this._leftControl.on("mousedown",function(t){var o,r,n,i;if(1===t.which)return e._leftControl.addClass(e._draggedClassName),e._dragged=!0,i=e.el.offset().left,n=t.clientX-e._leftControl.offset().left,o=0,r=e._rightControl.offset().left-i,$(document).on("mousemove",function(t){return e._controlMoveTo(e._leftControl,t.clientX,i,n,o,r)})}),this._rightControl.on("mousedown",function(t){var o,r,n,i,l;if(1===t.which)return e._rightControl.addClass(e._draggedClassName),e._dragged=!0,l=e.el.offset().left,o=e._controlWidth,i=t.clientX-e._rightControl.offset().left,r=e._leftControl.offset().left-l+e._controlWidth,n=e._width,$(document).on("mousemove",function(t){return e._controlMoveTo(e._rightControl,t.clientX,l,i,r,n)})}),$(document).on("mouseup",function(){return e._leftControl.triggerHandler("mouseup"),e._rightControl.triggerHandler("mouseup")}),this._renderLeftControl(this.leftValue()),this._renderRightControl(this.rightValue())},t.prototype._controlMoveTo=function(t,e,o,r,n,i){var l,s,a;return s=e-o-r,a=e-o-r+this._controlWidth,s>=n&&i>a&&t.css("left",s),n>s&&t.css("left",n),a>i&&t.css("left",i-this._controlWidth),l=t.position().left,t===this._leftControl&&this._leftValueWithoutRender(this._getValueByPosition(l)),t===this._rightControl?this._rightValueWithoutRender(this._getValueByPosition(l-this._controlWidth)):void 0},t.prototype._renderRange=function(){var t,e;return t=(this._leftControlValue-this._startValue)*this._pxInValue+this._controlWidth-this._controlWidth/2,e=(this._rightControlValue-this._startValue)*this._pxInValue+this._controlWidth+this._controlWidth/2,this._rangeElement.css({left:t,right:this._width-e})},t.prototype._renderLeftControl=function(t){return this._leftControl.css({left:(t-this._startValue)*this._pxInValue})},t.prototype._renderRightControl=function(t){return this._rightControl.css({left:this._controlWidth+(t-this._startValue)*this._pxInValue})},t.prototype._formatLeftControl=function(){return null!=this._formatControlCallback?this._leftControl.html(this._formatControlCallback(this.leftValue())):void 0},t.prototype._formatRightControl=function(){return null!=this._formatControlCallback?this._rightControl.html(this._formatControlCallback(this.rightValue())):void 0},t}(),$.fn.rangeControl=function(e){return 1!==this.size()?this.each(function(){var o;return void 0===$(this).data("rangeControl")?(o=new t($(this),e),$(this).data("rangeControl",o)):void 0}):$(this).data("rangeControl")}}).call(this);